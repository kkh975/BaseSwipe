/*!*
 * @autor: Blim - Koo Chi Hoon(kkh975@naver.com)
 * @license http://blim.mit-license.org/
 */
function SwipeBase(t){"use strict";function e(){var t=A.length;for(window.removeEventListener("resize",s),b.removeEventListener("touchstart",V.setStart);--t>-1;)A[t].removeEventListener("focus",o,!1),A[t].removeEventListener("blur",n,!1)}function n(){I&&null===N&&(N=setInterval(h,E.slideShowTime))}function o(){clearInterval(N),N=null}function s(){j=_width||b.offsetWidth}function i(t){T.style.height=t||A[r()].offsetHeight}function r(){return R}function a(t){R=t}function u(){return H}function l(t){H=t}function c(){var t=r();return--t<0&&(t=E.loop?D-1:-1),t}function d(){var t=r();return++t>D-1&&(t=E.loop?0:-1),t}function v(){f(c(),"prev")}function h(){f(d(),"next")}function f(t,e){var n=r(),o=t-n,s=1===arguments.length;return!J&&(t!==n&&(!(t<0||t>D-1)&&(!(k&&s&&(t>1||t%2==n%2))&&(s&&(e=o>0?"next":"prev"),k&&s&&t%2==1&&n%2==0&&(e="next"),b.addEventListener(O.transitionsendJs,y,!1),l(t),p(e),void m(E.duration,e)))))}function p(t){var e=r(),n=u();w(),Q.setCss3Transition(A[e],0,0),Q.setCss3Transition(A[n],0,"next"===t?_:-_),"function"==typeof E.before&&E.before(k?e%2:e)}function m(t,e){var n=r(),o=u(),s=Q.getCss3TransformPos(T),i=z="next"===e?-_:_;a(o),V.is_drag&&s%_==0?y():(V.is_drag?(t=t*(_-Math.abs(s))/_,t=Math.abs(t),t=Math.max(t,10)):t=t,Q.setCss3Transition(T,t,i),setTimeout(function(){0==Q.getCss3TransformPos(A[n])&&J&&y()},t+100))}function y(){for(var t=r(),e=c(),n=d(),o=D;--o>-1;)A[o].style.display=o==t||o==e||o==n?"block":"none";z=0,Q.setCss3Transition(T,0,z),Q.setCss3Transition(A[t],0,0),-1!==e&&Q.setCss3Transition(A[e],0,-_),-1!==n&&Q.setCss3Transition(A[n],0,_),b.removeEventListener(O.transitionsendJs,y,!1),S(),"function"==typeof E.active&&E.active(k?t%2:t)}function w(){J=!0,o()}function S(){J=!1,n()}function g(){P=!1}function x(t){P=t||!0}var _=100,E=null,b=null,T=null,A=null,C=null,M=null,L=null,$=null,B=null,N=null,P=!1,k=!1,I=!1,J=!1,j=0,z=0,D=0,R=0,H=0,O={},W={wrap:null,list:null,pages:null,toStart:null,toStop:null,toPrev:null,toNext:null,startEvents:"click",stopEvents:"click",moveEvents:"click",pageEvents:"click",startIdx:0,slideShowTime:3e3,touchMinumRange:10,scrollMinumRange:20,sideTouchLock:!1,loop:!0,duration:300,create:null,before:null,active:null},Q={extend:function(t,e){var n=null,o={};for(n in t)o[n]=n in e?e[n]:t[n];return o},isArray:function(t){return t&&"[object Array]"===Object.prototype.toString.call(t)},dom2Array:function(t){var e=[],n=0,o=0;if(t){if((o=t.length)>0)for(n=0;n<o;n++)e.push(t[n]);else e.push(t);return e}return null},object2Array:function(t){var e=[];for(var n in t)e.push(t[n]);return e},getCssPrefix:function(){var t=["-webkit-transition","transition"],e=["-webkit-transform","transform"],n=["webkitTransition","transition"],o=["webkitTransform","transform"],s=["webkitTransitionEnd","transitionend"],i=window.getComputedStyle(document.body,""),r=(Q.object2Array(i).join("").match(/-(webkit|moz|ms|o)-/)||""===i.OLink&&["","o"])[1],a="webkit"===r;return{prefixCss:r,prefixJs:"WebKit|Moz|MS|O".match(new RegExp("("+r+")","i"))[1].toLowerCase(),transitionsCss:t[a?0:1],transformsCss:e[a?0:1],transformsJs:o[a?0:1],transitionsJs:n[a?0:1],transitionsendJs:s[a?0:1]}},hasCss3Animation:function(){return O.transitionsJs in document.createElement("div").style},getCss3TransformPos:function(t){var e="";return e=t.style[O.transformsJs],e=e.substring(e.indexOf("(")+1,e.indexOf("%")),parseFloat(e)},setCss3Transition:function(t,e,n){Q.setCss3(t,"transition",e+"ms"),Q.setCss3(t,"transform","translate3d("+n+"%, 0, 0)")},setCss3:function(t,e,n){"transition"===e?t.style[O.transitionsJs]="ease-out "+n:"transform"===e?t.style[O.transformsJs]=n:(t.style[e]=n,t.style["-"+O.prefixJs+"-"+e]=n)},setBtnEvent:function(t,e,n){for(var o=e.split(","),s=o.length,i=t.length;--s>-1;)for(;--i>-1;)!function(e){t[e].addEventListener(o[s],function(t){n(e),t.preventDefault()})}(i)}},V={is_drag:null,is_disable:!1,touch_start_x:0,touch_start_y:0,touch_move_x1:0,touch_move_y1:0,move_dx:0,setInitVaiable:function(){V.is_drag=null,V.is_disable=!1,V.touch_start_x=0,V.touch_start_y=0,V.touch_move_x1=0,V.touch_move_y1=0,V.move_dx=0},canPrevMove:function(){return!(!E.loop&&-1===c())},canNextMove:function(){var t=d(),e=(k?D-2:D)-1;return!(!E.loop&&(-1===t||t>e))},setStart:function(t){!0===P||J||"touchstart"!==t.type||1!==t.touches.length||(o(),V.is_drag=null,V.touch_start_x=t.touches[0].pageX,V.touch_start_y=t.touches[0].pageY),b.addEventListener("touchmove",V.setMove),b.addEventListener("touchend",V.setEnd),b.addEventListener("touchcancel",V.setEnd)},setMove:function(t){if(!0!==P&&!J){var e=r(),n=0,o=0,s=!1;"touchmove"===t.type&&1===t.touches.length&&(V.touch_move_x1=t.touches[0].pageX,V.touch_move_y1=t.touches[0].pageY,n=V.touch_move_x1-V.touch_start_x,o=V.touch_move_y1-V.touch_start_y,s=n<0,V.move_dx=n/j*100,V.move_dx=Math.max(-100,Math.min(100,V.move_dx)),V.is_disable=s&&("next"===P||"right"===P)||!s&&("prev"===P||"left"===P),!E.loop&&E.sideTouchLock&&(!s&&0===e||s&&e===D-1)&&(V.is_disable=!0),null==V.is_drag&&(V.is_drag=V.is_drag||Math.abs(n)>Math.abs(o)),V.is_drag&&!V.is_disable&&(t.preventDefault(),V.is_drag=!0,Q.setCss3Transition(T,0,(E.loop?0:z)+V.move_dx)))}},setEnd:function(t){if(!V.is_disable&&!J){var e=Math.abs(V.move_dx)>E.touchMinumRange,n=V.move_dx<0,o=n?V.canNextMove():V.canPrevMove();V.is_drag&&e&&o?n?h():v():Q.setCss3Transition(T,E.duration,E.loop?0:z)}b.removeEventListener("touchmove",V.setMove),b.removeEventListener("touchend",V.setEnd),b.removeEventListener("touchcancel",V.setEnd),V.setInitVaiable()}};if(function(){if(E=Q.extend(W,t),T=Q.isArray(E.wrap)?E.wrap:Q.dom2Array(E.wrap),!(A=Q.isArray(E.list)?E.list:Q.dom2Array(E.list))||!T)return!1;if(D=A.length,T=T[0],b=T.parentNode,O=Q.getCssPrefix(),E.touchMinumRange=Math.max(1,Math.min(100,E.touchMinumRange)),D<2)return!1;if(!(Q.hasCss3Animation()&&"addEventListener"in window&&"querySelector"in document))return!1;if(E.slideShowTime&&("boolean"==typeof E.slideShowTime&&(I=E.slideShowTime)&&(E.slideShowTime=W.slideShowTime),"string"==typeof E.slideShowTime&&(E.slideShowTime=parseInt(E.slideShowTime,10)),isNaN(E.slideShowTime)?I=!1:(I=!0,2*E.duration>=E.slideShowTime&&(E.slideShowTime=2*E.duration))),E.toStart&&(M=Q.isArray(E.toStart)?E.toStart:Q.dom2Array(E.toStart),Q.setBtnEvent(M,E.startEvents,n)),E.toStop&&(L=Q.isArray(E.toStop)?E.toStop:Q.dom2Array(E.toStop),Q.setBtnEvent(L,E.stopEvents,o)),E.toPrev&&($=Q.isArray(E.toPrev)?E.toPrev:Q.dom2Array(E.toPrev),Q.setBtnEvent($,E.moveEvents,v)),E.toNext&&(B=Q.isArray(E.toNext)?E.toNext:Q.dom2Array(E.toNext),Q.setBtnEvent(B,E.moveEvents,h)),E.pages&&(C=Q.isArray(E.pages)?E.pages:Q.dom2Array(E.pages),Q.setBtnEvent(C,E.moveEvents,function(t){f(t)})),2===D&&E.loop){var e=null;e=A[0].cloneNode(!0),A.push(e),T.appendChild(e),e=A[1].cloneNode(!0),A.push(e),T.appendChild(e),k=!0,D=4}E.startIdx=Math.max(E.startIdx,0),E.startIdx=Math.min(E.startIdx,A.length),a(E.startIdx),window.addEventListener("resize",s),b.addEventListener("touchstart",V.setStart);for(var i=A.length;--i>-1;)A[i].addEventListener("focus",o,!1),A[i].addEventListener("blur",n,!1);return!0}())return function(){b.style.overflow="hidden",T.style.position="relative",Q.setCss3Transition(T,0,0),j=b.offsetWidth;for(var t=0,e=0,o=D,s=r()*-_;t<o;t++)e=_*t,e+=s,E.loop&&(_*(o-1)===e&&(e=-1*_),-1*_>e&&(e+=_*o)),A[t].style.position="absolute",Q.setCss3Transition(A[t],0,e);n(),"function"==typeof E.create&&E.create(r())}(),{startSlideShow:n,stopSlideShow:o,refreshSize:s,setHeight:i,getIdx:r,toNext:h,toPrev:v,toSlide:f,destory:e,touchEnable:g,touchDisable:x}}window.jQuery&&function(t){"use strict";var e="SwipeBase";t.fn.swipeBase=function(n){return n=n||{},n.$list=n.$list||t(this).find("> ul > li"),n.$wrap=n.$wrap||t(this).find("> ul"),n.wrap=n.$wrap.toArray()||[],n.list=n.$list.toArray()||[],n.pages=n.$pages&&n.$pages.toArray?n.$pages.toArray():[],n.toStart=n.$toStart&&n.$toStart.toArray?n.$toStart.toArray():[],n.toStop=n.$toStop&&n.$toStop.toArray?n.$toStop.toArray():[],n.toPrev=n.$toPrev&&n.$toPrev.toArray?n.$toPrev.toArray():[],n.toNext=n.$toNext&&n.$toNext.toArray?n.$toNext.toArray():[],this.each(function(){t(this).data(e,new SwipeBase(n))})},t.fn.swipeBase2start=function(){return this.each(function(){var n=t(this).data(e);void 0!==n&&void 0!==n.startSlideShow&&n.startSlideShow()})},t.fn.swipeBase2stop=function(){return this.each(function(){var n=t(this).data(e);void 0!==n&&void 0!==n.stopSlideShow&&n.stopSlideShow()})},t.fn.swipeBase2refresh=function(){return this.each(function(){var n=t(this).data(e);void 0!==n&&void 0!==n.refreshSize&&n.refreshSize()})},t.fn.swipeBase2setHeight=function(n){return this.each(function(){var o=t(this).data(e);void 0!==o&&void 0!==o.setHeight&&o.setHeight(n)})},t.fn.swipeBase2prev=function(){return this.each(function(){var n=t(this).data(e);void 0!==n&&void 0!==n.toPrev&&n.toPrev()})},t.fn.swipeBase2next=function(){return this.each(function(){var n=t(this).data(e);void 0!==n&&void 0!==n.toNext&&n.toNext()})},t.fn.swipeBase2slide=function(n){return this.each(function(){var o=t(this).data(e);void 0!==o&&void 0!==o.toSlide&&o.toSlide(n)})},t.fn.swipeBase2destory=function(n){return this.each(function(){var n=t(this).data(e);void 0!==n&&void 0!==n.destory&&n.destory()})},t.fn.swipeBase2touchEnable=function(){return this.each(function(){var n=t(this).data(e);void 0!==n&&void 0!==n.touchEnable&&n.touchEnable()})},t.fn.swipeBase2touchDisable=function(n){return this.each(function(){var o=t(this).data(e);void 0!==o&&void 0!==o.touchDisable&&o.touchDisable(n||!0)})}}(jQuery);


module.exports = SwipeBase;